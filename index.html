<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Video Player</title>
<style>
.video {
  width: 100%;
  height: auto;
}
</style> 
</head>
<body>
<select id="channelSelect">
<option value="">Выберите канал</option>
<!-- Опции добавятся здесь -->
</select>
<div id="playerContainer" class="video"></div>
<script src="https://cdn.jsdelivr.net/npm/playerjs@0.1.7/dist/player.js"></script>
<script>
async function loadPlaylist(playlistUrl) {
  try {
    const response = await fetch(playlistUrl);
    const body = await response.text();
    const lines = body.split('\n');
    const select = document.getElementById('channelSelect');
    for (let i = 0; i < lines.length; i++) {
      if (lines[i].startsWith('#EXTINF:')) {
        const title = lines[i].slice(lines[i].indexOf(',') + 1);
        const url = lines[++i].trim();
        const option = document.createElement('option');
        option.value = url;
        option.textContent = title;
        select.appendChild(option);
      }
    }
  } catch (error) {
    console.error('Не удалось загрузить плейлист:', error);
  }
}

let player = null;

window.onload = function() {
  player = new Playerjs({id:"player", file:""});
  loadPlaylist('https://evgeny-dmitrievich.github.io/iptv/iptv.m3u'); // Замените на свой URL плейлиста M3U
};

document.getElementById('channelSelect').addEventListener('change', function(){
  if(player){
    player.api("file", this.value);
  }
});
</script>
</body>
</html>
